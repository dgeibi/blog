<!DOCTYPE html><html lang="cmn-hans" manifest="/plain.appcache"><head><meta charset="utf-8"><title>设置终端下的代理 | dgeibi's blog</title><meta name="author" content="dgeibi"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta name="renderer" content="webkit|ie-comp|ie-stand"><link rel="stylesheet" href="/css/style.css"><link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml"><link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml"><link rel="canonical" href="https://blog.dgeibi.xyz/2015/11/25/terminal-proxy/index.html"><link rel="icon" type="image/png" href="/favicon.png"><link rel="apple-touch-icon" sizes="256x256" href="/favicon.png"><link rel="manifest" href="/manifest.json"><script src="/js/main.js" defer></script></head><body><header class="site-header"><div class="wrapper"><a class="site-title" href="/">dgeibi's blog</a><nav class="site-nav"><a class="nav-item" href="/archives/">归档 </a><a class="nav-item" href="/about/">关于 </a><a class="nav-item" href="/atom.xml">Feed </a></nav></div></header><main class="page-content"><div class="wrapper"><article class="post"><header class="post-header"><h1 class="post-title" itemprop="name headline">设置终端下的代理</h1><section class="meta">发表于 <time datetime="2015-11-25T13:33:40+08:00">2015-11-25</time>&nbsp;|&nbsp;修改于 <time datetime="2017-01-10T17:21:11+08:00">2017-01-10</time></section><section class="meta"></section><section class="meta">标签: &nbsp;<span><a href="/archives/tags/linux/">#Linux</a></span>&nbsp;<span><a href="/archives/tags/network/">#网络</a></span></section></header><section id="toc"><h2 class="heading">Content</h2><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#参考"><span class="toc-number">1.</span> <span class="toc-text">参考</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装-Connect"><span class="toc-number">2.</span> <span class="toc-text">安装 Connect</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP-的配置"><span class="toc-number">3.</span> <span class="toc-text">HTTP 的配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#git-协议的配置"><span class="toc-number">4.</span> <span class="toc-text">git 协议的配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSH-的配置"><span class="toc-number">5.</span> <span class="toc-text">SSH 的配置</span></a></li></ol></section><section class="post-content toc-src" itemprop="articleBody"><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="http://segmentfault.com/q/1010000000118837/a-1020000000132541" target="_blank" rel="external">如何为 Git 设置代理？</a></li>
<li><a href="https://wiki.archlinux.org/index.php/Proxy_settings" target="_blank" rel="external">Proxy settings - ArchWiki</a></li>
<li><a href="http://manpages.ubuntu.com/manpages/natty/man1/connect-proxy.1.html" target="_blank" rel="external">connect-proxy manpages</a></li>
<li><a href="https://wiki.archlinux.org/index.php/HTTP_tunneling" target="_blank" rel="external">HTTP tunneling - ArchWiki</a></li>
</ul>
<h2 id="安装-Connect"><a href="#安装-Connect" class="headerlink" title="安装 Connect"></a>安装 <a href="https://bitbucket.org/gotoh/connect/wiki/Home" target="_blank" rel="external">Connect</a></h2><figure class="highlight sh"><table><tr><td class="code"><pre><div class="line"><span class="comment">#ubuntu</span></div><div class="line">sudo apt-get install connect-proxy</div><div class="line"><span class="comment">#archlinux</span></div><div class="line">yaourt -S connect <span class="comment"># https://aur.archlinux.org/packages/connect</span></div></pre></td></tr></table></figure>
<h2 id="HTTP-的配置"><a href="#HTTP-的配置" class="headerlink" title="HTTP 的配置"></a>HTTP 的配置</h2><figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">vi ~/.bashrc</div><div class="line"><span class="comment">#添加以下内容</span></div><div class="line"><span class="built_in">export</span> http_proxy=http://127.0.0.1:7070/</div><div class="line"><span class="built_in">export</span> https_proxy=<span class="variable">$http_proxy</span></div><div class="line"><span class="built_in">export</span> ftp_proxy=<span class="variable">$http_proxy</span></div></pre></td></tr></table></figure>
<h2 id="git-协议的配置"><a href="#git-协议的配置" class="headerlink" title="git 协议的配置"></a>git 协议的配置</h2><figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">sudo vi /usr/bin/gitproxy.sh</div><div class="line">-----</div><div class="line"><span class="meta">#!/bin/bash</span></div><div class="line">connect -H 127.0.0.1:7070 $*</div></pre></td></tr></table></figure>
<p><code>-H</code> 表示 HTTP，将 <code>-H</code> 改成 <code>-S</code> 可以用 SOCKS5 协议</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">sudo chmod +x /usr/bin/gitproxy.sh</div><div class="line">git config --global core.gitproxy <span class="string">'gitproxy.sh for kernel.org'</span></div></pre></td></tr></table></figure>
<p><code>for kernel.org</code> 表示只有那个域名需要代理，当然可以不加 <code>for *</code></p>
<h2 id="SSH-的配置"><a href="#SSH-的配置" class="headerlink" title="SSH 的配置"></a>SSH 的配置</h2><figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">vi ~/.ssh/config</div><div class="line">-----</div><div class="line"><span class="comment">##not using proxy on lan</span></div><div class="line"><span class="comment">#Host 192.*</span></div><div class="line"><span class="comment">#    ProxyCommand connect-proxy %h %p</span></div><div class="line">Host github.com</div><div class="line">    User git</div><div class="line">    ProxyCommand connect -H 127.0.0.1:7070 %h %p</div></pre></td></tr></table></figure>
<p>除了 Connect 还有很多其他的选择，如 corscrew (仅支持 HTTP 代理)</p>
<p>将下列命令替换到上述相应位置即可</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><div class="line"><span class="comment">#git</span></div><div class="line">corkscrew 127.0.0.1 7070 $*</div><div class="line"><span class="comment">#SSH</span></div><div class="line">ProxyCommand corkscrew 127.0.0.1 7070 %h %p</div></pre></td></tr></table></figure>
</section></article></div></main><footer class="site-footer"><section><small>&copy; 2015-2017
 dgeibi <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></small></section><section><small>Powered by <a href="https://hexo.io">Hexo</a>. Theme by <a href="https://github.com/dgeibi">dgeibi</a>.</small></section></footer><a class="back-to-top" data-js-backtotop href="#" title="Back to top">&uarr;</a></body></html>